Сам алгоритм почти не изменился, работал над экономией памяти. Благодаря bitset'у, память на 1 регистр составляет 5 бит, а общая память составляет $1024 * 5 \ \ бит = 5120 \ битов \ = 640 \ байтов\ $. В сравнении с обычной версией, использование памяти сократилось в $6.4$ раз